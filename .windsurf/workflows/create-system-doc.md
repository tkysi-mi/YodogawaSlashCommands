# /create-system-doc

## 目的

- `@.windsurf/templates/system-description-template.md`を基に、新規システムの全体像を記述したドキュメントを作成する。
- ビジネス要件から技術仕様まで一貫性のある情報を整備し、後続の設計・実装フェーズで活用できる状態にする。

## 前提

- プロダクトの目的・ターゲットユーザー・主要課題について、依頼元から何らかの情報が共有済みである。
- Windsurfの`code_search`/`read_file`で既存資料（チケット、要件書、口頭合意メモなど）にアクセスできる。
- Mermaid記法で画面遷移やアクティビティ図を記述できる環境がある。
- 作成したドキュメントを保存するリポジトリまたはフォルダが決まっている。

## 手順

### 1. 情報収集と整理

- 依頼内容、既存の要件定義書、チケット、ミーティングノートを`code_search`/`read_file`で確認する。
- 以下の情報を箇条書きで整理する：
  - プロダクトの目的と価値訴求
  - ターゲットユーザー像
  - 解決すべき課題（現状の問題点）
  - 主要な業務要件
  - 想定される機能要件
  - 画面構成のイメージ
- 不明点や曖昧な箇所があれば、依頼元またはステークホルダーに即座に質問し、暫定判断を避ける。

### 2. テンプレートの展開

- `@.windsurf/templates/system-description-template.md`を読み込む。
- 保存先パス（例: `docs/system-overview.md`）を決定し、テンプレートをコピーする。
- ファイル名はプロダクト名やプロジェクトコードを含む形式にする（例: `docs/product-X-system-overview.md`）。

### 3. セクションごとの記入

以下の順序で各セクションを埋めていく：

#### 3.1 プロダクト概要（セクション1）
- 目的、ターゲットユーザー、主要価値を簡潔にまとめる。
- 1〜2文で要約し、詳細は後続セクションに委ねる。

#### 3.2 背景・課題（セクション2）
- 収集した課題情報を表形式で整理する。
- 各課題にIDを付与し、解決方針を明記する。
- IF 課題が5個以上ある THEN 優先度を付けて重要なものに絞る。

#### 3.3 業務要件（セクション3）
- 業務プロセス視点で「誰が何をするか」を整理する。
- 実施者とシステム化範囲を明確にし、対応する課題IDと紐づける。

#### 3.4 機能要件（セクション4）
- 業務要件を実現するための具体的な機能を列挙する。
- 各機能に管理番号を付与し、対応する業務要件IDを記載する。
- UI/機能の概要を簡潔に記述する。

#### 3.5 画面一覧（セクション5）
- 主要な画面とその役割を整理する。
- 対応する機能要件IDを明記し、トレーサビリティを確保する。

#### 3.6 画面遷移（セクション6）
- Mermaid flowchartで主要な画面遷移を図示する。
- 正常系の遷移を中心に、例外フロー（エラー、キャンセル）も追加する。
- IF 画面数が10以上ある THEN 主要フローのみに絞り、詳細は別図に分割する。

#### 3.7 アクティビティ図（セクション7）
- Mermaid stateDiagramでアクター視点の活動フローを記述する。
- 状態遷移と分岐条件を明示し、ビジネスロジックの概要を可視化する。

#### 3.8 概念一覧（セクション8）
- システム内の主要なドメイン概念（エンティティ）を定義する。
- 関連概念との関係性を記載し、データモデル設計の基礎情報とする。

#### 3.9 テストケースサマリ（セクション9）
- 主要な機能要件に対応する受入基準をBDD形式（Given-When-Then）で記述する。
- 全機能を網羅する必要はなく、代表的なシナリオを2〜3個程度記載する。

#### 3.10 補足・メモ（セクション10）
- 特記事項、前提条件、未決事項、参考資料リンクなどを自由記述する。
- 後続の設計フェーズで確認すべき事項があればここに記載する。

### 4. 品質チェック

以下を確認し、未達の場合は修正する：
- [ ] 各セクションが埋まっているか（情報が無い場合は「未定」と明記）
- [ ] 管理番号（P-01、BR-01、FR-01など）が一貫して付与されているか
- [ ] 業務要件→機能要件→画面のトレーサビリティが取れているか
- [ ] Mermaid図が正しく描画されるか（構文エラーがないか）
- [ ] 用語の表記揺れがないか（例: ユーザー/ユーザ、ログイン/サインイン）
- [ ] 依頼元の期待値と整合しているか

### 5. ステークホルダーレビュー

- 作成したドキュメントを依頼元、プロダクトオーナー、主要開発メンバーと共有する。
- レビューコメントを収集し、齟齬があれば即座に修正する。
- 合意が取れたら、レビュー履歴をドキュメント内または別途管理システムに記録する。

### 6. 保存と次工程への連携

- 最終版をリポジトリにコミットし、変更履歴を残す。
- READMEまたはプロジェクトWikiに本ドキュメントへのリンクを追加する。
- 後続ワークフロー（例: `/dev-2-planning`、`/dev-3-system-design`）で参照する際のパスを明記する。
- IF 詳細設計が必要 THEN `/dev-3-system-design`を起動し、本ドキュメントを入力とする。

## 完了条件

- システム概要ドキュメントが`system-description-template.md`の全セクションを埋めた形で完成している。
- 業務要件・機能要件・画面遷移のトレーサビリティが確保されている。
- 主要ステークホルダーとレビュー済みで、合意が取れている。
- ドキュメントがリポジトリに保存され、後続フェーズから参照可能な状態になっている。

## エスカレーション

- 依頼内容が不明確で情報収集が進まない場合は、プロダクトオーナーまたは依頼元に決裁を依頼する。
- 業務要件と機能要件の整合が取れない場合は、ビジネス側とエンジニアリング側の関係者を招集し調整会議を設定する。
- Mermaid図が複雑になりすぎて可読性が低下した場合は、別ツール（draw.io、Figmaなど）での作成を検討し、画像リンクで代替する。
